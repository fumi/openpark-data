#!/bin/sh

. ./config.sh

IMPORT_DIR=/Users/fumi/lodi/openpark/data/import

function import_turtle {
  FILE=$1
  CONTEXT=$2
  echo "ttlp_mt(file_to_string_output('${FILE}'), '', '${CONTEXT}');" | ${ISQL} ${HOSTNAME} -U ${V_USER} -P ${V_PASS}
}
function import_rdfxml {
  FILE=$1
  CONTEXT=$2
  echo "rdf_load_rdfxml_mt(file_to_string_output('${FILE}'), '', '${CONTEXT}');" | ${ISQL} ${HOSTNAME} -U ${V_USER} -P ${V_PASS}
}

echo "Initializing Database ..."
echo "RDF_GLOBAL_RESET();" | ${ISQL} ${HOSTNAME} -U ${V_USER} -P ${V_PASS}

echo "Importing files ..."
for file in ${IMPORT_DIR}/*.ttl
do
  echo "... ${file} ..."
  import_turtle ${file} "http://kanazawa.permit.jp"
done
